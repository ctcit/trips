
(function () {
    'use strict';

    angular.module('tripApp').factory('tripsService',
        ['site', '$http', '$q', 'Group', 'Trip', 'Participant',
        function (site, $http, $q, Group, Trip, Participant) {

            //---------------------------------
            // Following variables are obtained as side-effects of getting trips
            // They are cached in this service 
            // (I suggest they be put into their own API methods)

            var config = {};
            var metadata = undefined;
            var userId = undefined;
            var editId = undefined;
            var participants = [];
            var members = [];
            var nonmembers = [];
            var edits = [];
            var modifications = [];
            var changes = [];


            //---------------------------------

            function getTripGroups() {

                //return $http.get(site.getresturl + "?action=gettrips")
                return $q.when()
                    .then(function (response) {
                        response = { "action": "gettrips", "config": { "EditorRoles": "'Webmaster','Overnight Trip Organiser','Day Trip Organiser','Club Captain'", "EmailFilter": "\/^alastairgbrown@yahoo\\.com\\.au$\/", "BaseUrl": "http:\/\/www.ctc.org.nz\/trips", "ShowDebugUpdate": false, "AdditionalLines": 5, "EditRefreshInSec": 30 }, "userid": 520, "metadata": { "trips": { "id": { "Field": "id", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "PRI", "Default": null, "Extra": "auto_increment", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "eventid": { "Field": "eventid", "Type": "int(11)", "Collation": null, "Null": "YES", "Key": "UNI", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "title": { "Field": "title", "Type": "varchar(120)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Title -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Title" }, "date": { "Field": "date", "Type": "date", "Collation": null, "Null": "NO", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Date", "IsReadOnly": false, "Display": "Date" }, "length": { "Field": "length", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Length", "IsReadOnly": false, "Display": "Length" }, "departurePoint": { "Field": "departurePoint", "Type": "varchar(255)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Departure Point -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Departure Point" }, "grade": { "Field": "grade", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Grade -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Grade" }, "cost": { "Field": "cost", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Cost -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Cost" }, "closeDate": { "Field": "closeDate", "Type": "date", "Collation": null, "Null": "NO", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Close Date", "IsReadOnly": false, "Display": "Close Date" }, "status": { "Field": "status", "Type": "text", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Status -- status text, normally updated by the leader to communicate to participants", "IsReadOnly": false, "Display": "Status" }, "isOpen": { "IsReadOnly": true, "Type": "tinyint(1)" } }, "participants": { "id": { "Field": "id", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "PRI", "Default": null, "Extra": "auto_increment", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "tripid": { "Field": "tripid", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "MUL", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "line": { "Field": "line", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "", "Default": "0", "Extra": "", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "isRemoved": { "Field": "isRemoved", "Type": "tinyint(1)", "Collation": null, "Null": "NO", "Key": "", "Default": "0", "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Removed", "IsReadOnly": false, "Display": "Removed" }, "memberid": { "Field": "memberid", "Type": "int(11)", "Collation": null, "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "", "IsReadOnly": false, "Display": "" }, "isLeader": { "Field": "isLeader", "Type": "tinyint(1)", "Collation": null, "Null": "NO", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Leader", "IsReadOnly": false, "Display": "Leader" }, "name": { "Field": "name", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Name -- if null use value from ctcweb9_ctc.members", "IsReadOnly": false, "Display": "Name" }, "email": { "Field": "email", "Type": "varchar(255)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Email -- if null use the primaryEmail value from from ctcweb9_ctc.members table", "IsReadOnly": false, "Display": "Email" }, "phone": { "Field": "phone", "Type": "varchar(20)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Phone -- if null use the homePhone from from ctcweb9_ctc.memberships table", "IsReadOnly": false, "Display": "Phone" }, "isVehicleProvider": { "Field": "isVehicleProvider", "Type": "tinyint(1)", "Collation": null, "Null": "NO", "Key": "", "Default": "0", "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Car?", "IsReadOnly": false, "Display": "Car?" }, "vehicleRego": { "Field": "vehicleRego", "Type": "varchar(10)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Rego", "IsReadOnly": false, "Display": "Rego" }, "status": { "Field": "status", "Type": "text", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Status", "IsReadOnly": false, "Display": "Status" } } }, "groups": [{ "name": "My Trips", "isMyTrips": true, "trips": [{ "tripid": "69", "eventid": "2714", "date": "2016-06-18", "closeDate": "2016-06-18", "isOpen": "1", "length": "W\/E", "departurePoint": "", "grade": "Easy or EasyMod", "cost": "$40", "title": "Mid winter dance party on Lewis tops!", "status": "", "text": "What better way is there to keep warm in the middle of winter other than dancing while enjoying the magnificent views of the Lewis pass tops in winter???\r\n\r\nThe weekend of 18-19 June is closest to the winter solstice and also corresponds with a full moon (well almost anyway).\r\n\r\nDeparting Christchurch at the respectable hour of 9am on Saturday morning and with cafe stop en-route. We will drive to the Lewis pass summit (upper St James carpark) from there walk up to the Lewis pass tops. We will walk along the broad ridge towards Mt Technical and The Apprentice (Approx 2-3 hours).  Nestled in the upper Deer Valley I have spied a broad valley (several actually) with plenty of flat land for tents and stunning views of said nearby peaks, I have also checked the direction of the rising sun to ensure early warming for those who place tents wisely.\r\n\r\nThis will be a mid winter alpine experience so you will need to have suitable gear for the climate. You will need winter tent, sleeping mat with good R value and a sleeping bag suitable for winter conditions as well as warm clothing.  You will need ice axe and crampons and know how to use them too - while the tops are quite flat there is some steep portions on the walk in and we are hoping for snow (fingers crossed). And don't forget your dancing shoes, silly Hat and Tie!\r\n\r\nPS I am serious about this being a dancing party trip.  As soon as our dinner has settled we will put on out silly hats and ties (shoes optional) and dance until the batteries are flat (either ours of those in the portable Bluetooth speakers).  If you wake up cold - then dance some more... There is heaps of space to dance in the snow with low risk so there are no excuses.  There is also space for low angle snow play - think impromptu tobogganing with pack liner\u2026\r\n\r\nLastly.... Dance moves that go on trip, stay on trip! \r\n\r\n", "leader": "James Hopkins", "role": "Participant" }] }, { "name": "Open Trips" }, { "name": "Closed Trips" }] };
                        if (ValidateResponse(response)) {
                            // cache these values
                            config = response.config;
                            metadata = response.metadata;
                            userId = response.userid;

                            // resolve on this value
                            return response.groups.map(function (groupData) {
                                return new Group(groupData, response.metadata.trips);
                            });
                        }
                    });
            }

            function getTrip(tripId, editId) {
                var queryString = "?action=gettrip&tripid=" + tripId + (editId != undefined ? ("&editid=" + editid) : "");

                //return $http.get(site.getresturl + queryString)
                return $q.when()
                    .then(function (response) {
                        response = response = { "action": "gettrip", "config": { "EditorRoles": "'Webmaster','Overnight Trip Organiser','Day Trip Organiser','Club Captain'", "EmailFilter": "\/^alastairgbrown@yahoo\\.com\\.au$\/", "BaseUrl": "http:\/\/www.ctc.org.nz\/trips", "ShowDebugUpdate": false, "AdditionalLines": 5, "EditRefreshInSec": 30 }, "userid": 520, "metadata": { "trips": { "id": { "Field": "id", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "PRI", "Default": null, "Extra": "auto_increment", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "eventid": { "Field": "eventid", "Type": "int(11)", "Collation": null, "Null": "YES", "Key": "UNI", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "title": { "Field": "title", "Type": "varchar(120)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Title -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Title" }, "date": { "Field": "date", "Type": "date", "Collation": null, "Null": "NO", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Date", "IsReadOnly": false, "Display": "Date" }, "length": { "Field": "length", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Length", "IsReadOnly": false, "Display": "Length" }, "departurePoint": { "Field": "departurePoint", "Type": "varchar(255)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Departure Point -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Departure Point" }, "grade": { "Field": "grade", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Grade -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Grade" }, "cost": { "Field": "cost", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Cost -- if null use the value from from ctcweb9_newsletter.event table", "IsReadOnly": false, "Display": "Cost" }, "closeDate": { "Field": "closeDate", "Type": "date", "Collation": null, "Null": "NO", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Close Date", "IsReadOnly": false, "Display": "Close Date" }, "status": { "Field": "status", "Type": "text", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Status -- status text, normally updated by the leader to communicate to participants", "IsReadOnly": false, "Display": "Status" }, "isOpen": { "IsReadOnly": true, "Type": "tinyint(1)" } }, "participants": { "id": { "Field": "id", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "PRI", "Default": null, "Extra": "auto_increment", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "tripid": { "Field": "tripid", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "MUL", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "line": { "Field": "line", "Type": "int(11)", "Collation": null, "Null": "NO", "Key": "", "Default": "0", "Extra": "", "Privileges": "select,insert,update,references", "Comment": "READONLY", "IsReadOnly": true, "Display": "" }, "isRemoved": { "Field": "isRemoved", "Type": "tinyint(1)", "Collation": null, "Null": "NO", "Key": "", "Default": "0", "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Removed", "IsReadOnly": false, "Display": "Removed" }, "memberid": { "Field": "memberid", "Type": "int(11)", "Collation": null, "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "", "IsReadOnly": false, "Display": "" }, "isLeader": { "Field": "isLeader", "Type": "tinyint(1)", "Collation": null, "Null": "NO", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Leader", "IsReadOnly": false, "Display": "Leader" }, "name": { "Field": "name", "Type": "varchar(50)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Name -- if null use value from ctcweb9_ctc.members", "IsReadOnly": false, "Display": "Name" }, "email": { "Field": "email", "Type": "varchar(255)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Email -- if null use the primaryEmail value from from ctcweb9_ctc.members table", "IsReadOnly": false, "Display": "Email" }, "phone": { "Field": "phone", "Type": "varchar(20)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Phone -- if null use the homePhone from from ctcweb9_ctc.memberships table", "IsReadOnly": false, "Display": "Phone" }, "isVehicleProvider": { "Field": "isVehicleProvider", "Type": "tinyint(1)", "Collation": null, "Null": "NO", "Key": "", "Default": "0", "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Car?", "IsReadOnly": false, "Display": "Car?" }, "vehicleRego": { "Field": "vehicleRego", "Type": "varchar(10)", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Rego", "IsReadOnly": false, "Display": "Rego" }, "status": { "Field": "status", "Type": "text", "Collation": "latin1_swedish_ci", "Null": "YES", "Key": "", "Default": null, "Extra": "", "Privileges": "select,insert,update,references", "Comment": "Status", "IsReadOnly": false, "Display": "Status" } } }, "changes": [[{ "id": "2", "line": "1", "memberid": "520", "timestamp": "2016-05-14 22:17:38", "action": "updatepart", "column": "isRemoved", "before": "0", "after": "1", "subject": null, "body": null, "emailAudit": "Email recipients: " }], [{ "id": "1", "line": "1", "memberid": "520", "timestamp": "2016-05-14 22:17:16", "action": "insertpart", "column": "memberid", "before": "", "after": "520", "subject": null, "body": null, "emailAudit": "Email recipients: James Hopkins (snikpohsemaj@gmail.com FILTERED)" }]], "trip": { "tripid": "69", "eventid": "2714", "date": "2016-06-18", "closeDate": "2016-06-18", "isOpen": "1", "length": "W\/E", "departurePoint": "", "grade": "Easy or EasyMod", "cost": "$40", "title": "Mid winter dance party on Lewis tops!", "status": "", "text": "What better way is there to keep warm in the middle of winter other than dancing while enjoying the magnificent views of the Lewis pass tops in winter???\r\n\r\nThe weekend of 18-19 June is closest to the winter solstice and also corresponds with a full moon (well almost anyway).\r\n\r\nDeparting Christchurch at the respectable hour of 9am on Saturday morning and with cafe stop en-route. We will drive to the Lewis pass summit (upper St James carpark) from there walk up to the Lewis pass tops. We will walk along the broad ridge towards Mt Technical and The Apprentice (Approx 2-3 hours).  Nestled in the upper Deer Valley I have spied a broad valley (several actually) with plenty of flat land for tents and stunning views of said nearby peaks, I have also checked the direction of the rising sun to ensure early warming for those who place tents wisely.\r\n\r\nThis will be a mid winter alpine experience so you will need to have suitable gear for the climate. You will need winter tent, sleeping mat with good R value and a sleeping bag suitable for winter conditions as well as warm clothing.  You will need ice axe and crampons and know how to use them too - while the tops are quite flat there is some steep portions on the walk in and we are hoping for snow (fingers crossed). And don't forget your dancing shoes, silly Hat and Tie!\r\n\r\nPS I am serious about this being a dancing party trip.  As soon as our dinner has settled we will put on out silly hats and ties (shoes optional) and dance until the batteries are flat (either ours of those in the portable Bluetooth speakers).  If you wake up cold - then dance some more... There is heaps of space to dance in the snow with low risk so there are no excuses.  There is also space for low angle snow play - think impromptu tobogganing with pack liner\u2026\r\n\r\nLastly.... Dance moves that go on trip, stay on trip! \r\n\r\n" }, "participants": [{ "line": "0", "isRemoved": "0", "memberid": "2050", "isLeader": "1", "name": "James Hopkins", "email": "snikpohsemaj@gmail.com", "phone": "022 026 0504", "isVehicleProvider": "0", "vehicleRego": "", "status": "" }, { "line": "1", "isRemoved": "1", "memberid": "520", "isLeader": "0", "name": "Bruce James", "email": "bruce.s.james@gmail.com", "phone": "332-3473", "isVehicleProvider": "0", "vehicleRego": "", "status": "" }], "members": [{ "id": "2129", "name": "Adam Burke", "email": "ajmburke@gmail.com", "phone": "020 456 7811", "role": null }, { "id": "2166", "name": "Adam Jensen", "email": "adamjensennzl@gmail.com", "phone": "027 381 0581", "role": null }, { "id": "150", "name": "Adrian Busby", "email": "adrian.busby1@gmail.com", "phone": "325-5001", "role": null }, { "id": "2094", "name": "Adrian Radcliffe", "email": "aradcliffe86@outlook.com", "phone": "0220105659", "role": null }, { "id": "960", "name": "Adrian Sullivan", "email": "adesullivan@yahoo.com", "phone": "03 310-0607", "role": null }, { "id": "231", "name": "Adrie Dawson", "email": "", "phone": "384-9542", "role": null }, { "id": "1080", "name": "Adrienne Witty", "email": "", "phone": "385-2132", "role": null }, { "id": "790", "name": "Alan Ross", "email": "alan_sue@xtra.co.nz", "phone": "384-6425", "role": "Club Captain" }, { "id": "125", "name": "Alastair Brown", "email": "alastairgbrown@yahoo.com.au", "phone": "338-1324", "role": "Webmaster" }, { "id": "2049", "name": "Alexandra Smedley", "email": "smedley@xtra.co.nz", "phone": "03 3510711", "role": null }, { "id": "1095", "name": "Alice Yung", "email": "alice.yung@mbie.govt.nz", "phone": "382-3988", "role": null }, { "id": "260", "name": "Alison Downard", "email": "alison.downard@canterbury.ac.nz", "phone": "3572089", "role": null }, { "id": "1967", "name": "Andrea Zahn", "email": "andi.zahn@gmx.de", "phone": "382 1044", "role": null }, { "id": "2194", "name": "Andrew Ecker", "email": "andrew_ecker@hotmail.com", "phone": "03 359 5298", "role": null }, { "id": "2058", "name": "Andrew John Pratt", "email": "andy.pratt@canterbury.ac.nz", "phone": "03 326 7072", "role": null }, { "id": "1872", "name": "Andrew Proffit", "email": "andrewproffit@mac.com", "phone": "337-2913", "role": null }, { "id": "915", "name": "Andrew Sheppard", "email": "d_sheppard@clear.net.nz", "phone": "342-7929", "role": null }, { "id": "2124", "name": "Andrew Smith", "email": "andrew.smiffy@gmail.com", "phone": "+61417411349", "role": null }, { "id": "1250", "name": "Andrew Tromans", "email": "atromans@gmail.com", "phone": "337-3925", "role": null }, { "id": "397", "name": "Andrew Turton", "email": "Andrew.Turton@bondor.co.nz", "phone": "332-8275", "role": null }, { "id": "1600", "name": "Andrew White", "email": "andrew8w@gmail.com", "phone": "03-337-3494", "role": null }, { "id": "1090", "name": "Andrew Wrapson", "email": "andrewwrapson@yahoo.co.nz", "phone": "980-6006", "role": null }, { "id": "2108", "name": "Andy Morris", "email": "andy.morris@generalcable.co.nz", "phone": "03-310-7114", "role": null }, { "id": "2043", "name": "Angela Lowery", "email": "lowery_ang@hotmail.com", "phone": "0220889370", "role": null }, { "id": "2071", "name": "Angie Scott", "email": "angie.scott@xtra.co.nz", "phone": "03 326 4177", "role": null }, { "id": "1952", "name": "Anna Gruczynska", "email": "poledownunder@yahoo.com", "phone": "03 980 2204", "role": null }, { "id": "2081", "name": "Anna Herlender", "email": "annaher@poczta.fm", "phone": "022 1071578", "role": null }, { "id": "2001", "name": "Anna Schmidli", "email": "annas@snap.net.nz", "phone": "355 8288", "role": null }, { "id": "435", "name": "Anne Henderson", "email": "", "phone": "352-8058", "role": null }, { "id": "2048", "name": "Anthony Clark", "email": "anthony@signflair.co.nz", "phone": "021474467", "role": null }, { "id": "2174", "name": "Antony Fairbanks", "email": "antony.fairbanks@canterbury.ac.nz", "phone": "03 337 2261", "role": null }, { "id": "1907", "name": "Antony White", "email": "phoenixantony@gmail.com", "phone": "03-550-7166", "role": null }, { "id": "1993", "name": "Astrid Natalia Gianotti", "email": "a.gianotti@gmail.com", "phone": "021 101 6438", "role": null }, { "id": "1055", "name": "Ava Whimp", "email": "", "phone": "03 313-7306", "role": null }, { "id": "1630", "name": "Ava-Ruth Baker", "email": "arbak@clear.net.nz", "phone": "332-8594", "role": null }, { "id": "2185", "name": "Bassam Maghzal", "email": "bassam.maghzal@gmail.com", "phone": null, "role": null }, { "id": "705", "name": "Bernhard Parawa", "email": "gerryparawa@hotmail.com", "phone": "337 3125", "role": null }, { "id": "177", "name": "Bev Clark", "email": "bndclark@xtra.co.nz", "phone": "326-6544", "role": null }, { "id": "2144", "name": "Bill Johnson", "email": "bill@billjohnson.nz", "phone": "022 049 3453", "role": "Overnight Trip Organiser" }, { "id": "2095", "name": "Boris De Bouck", "email": "cmrolin@gmail.com", "phone": "021 2046545 or 021 2", "role": null }, { "id": "1120", "name": "Brenda Rainsbury", "email": "robert@rainsbury.co.nz", "phone": "338-1933", "role": null }, { "id": "1980", "name": "Brennan Edwardes", "email": "benenepe@gmail.com", "phone": "07 543 4558", "role": null }, { "id": "1968", "name": "Brian Dougan", "email": "srotje@yahoo.com", "phone": "027 8447914", "role": null }, { "id": "1861", "name": "Brindsley Archer", "email": "brindsley.archer@xtra.co.nz", "phone": "342-3314", "role": null }, { "id": "1869", "name": "Bruce Cameron", "email": "Tecbruce@gmail.com", "phone": "03 3899618", "role": null }, { "id": "465", "name": "Bruce Hinkley", "email": "tryicon@xtra.co.nz", "phone": "322-6975", "role": null }, { "id": "520", "name": "Bruce James", "email": "bruce.s.james@gmail.com", "phone": "332-3473", "role": "Webmaster" }, { "id": "600", "name": "Bruce Long", "email": "", "phone": "352-3536", "role": null }, { "id": "1165", "name": "Bryce Williamson", "email": "bryce.williamson68@gmail.com", "phone": "351-6366", "role": null }, { "id": "655", "name": "Carl McKay", "email": "carlmckay2002@hotmail.com", "phone": "03 302 8986", "role": null }, { "id": "2114", "name": "Carol Horgan", "email": "freestone.horgan@ihug.co.nz", "phone": "03 322 8976", "role": null }, { "id": "1909", "name": "Cathy Harlow", "email": "cathy.citcat.harlow@gmail.com", "phone": "349-2280", "role": null }, { "id": "555", "name": "Cathy Kilroy", "email": "c.kilroy@niwa.co.nz", "phone": null, "role": null }, { "id": "2109", "name": "Charlotte Breen", "email": "cabreen@gmail.com", "phone": "027-275-6207", "role": null }, { "id": "1929", "name": "Chris Bamford", "email": "bambam001@hotmail.com", "phone": "03-317-9992", "role": null }, { "id": "205", "name": "Chris Cox", "email": "chris.cox@xtra.co.nz", "phone": "03-219-1414", "role": null }, { "id": "220", "name": "Chris Curry", "email": "chris.curry@xtra.co.nz", "phone": "351-5913", "role": null }, { "id": "2177", "name": "Chris Grant", "email": "chris.g2008@live.co.uk", "phone": "022 399 2874", "role": null }, { "id": "1320", "name": "Chris Markham", "email": "", "phone": "0274769209", "role": null }, { "id": "2088", "name": "Chris McGimpsey", "email": "judychris@xnet.co.nz", "phone": "03 3589125", "role": null }, { "id": "2197", "name": "Chris Todd", "email": "getcrtodd@gmail.com", "phone": "03 351 1813", "role": null }, { "id": "505", "name": "Christine Hunt", "email": "", "phone": "385-8434", "role": null }, { "id": "420", "name": "Claire Healing", "email": "jonoandclaire@xtra.co.nz", "phone": "03-755-6988", "role": null }, { "id": "2096", "name": "Clemence Rolin", "email": "cmrolin@gmail.com", "phone": "021 2046545 or 021 2", "role": null }, { "id": "1290", "name": "Clive Davidson", "email": "clive@toniq.co.nz", "phone": "351-1336", "role": null }, { "id": "1170", "name": "Clive Marsh", "email": "clive.marsh@clear.net.nz", "phone": "325-6253", "role": null }, { "id": "85", "name": "Craig Beere", "email": "havokk@ihug.co.nz", "phone": "381-0839", "role": null }, { "id": "1950", "name": "Craig Bunt", "email": "crbenz@gmail.com", "phone": "03-325-7764", "role": null }, { "id": "1978", "name": "Cristina Zablan", "email": "cristimo28@gmail.com", "phone": "03 374 6354", "role": null }, { "id": "320", "name": "Cyril Fifield", "email": "acfifield@vodafone.co.nz", "phone": "349-9305", "role": null }, { "id": "2010", "name": "Daniel Fraser", "email": "danny_fraser011@hotmail.com", "phone": "03 428 6327", "role": null }, { "id": "2030", "name": "Daniel Slater", "email": "danslater555@hotmail.com", "phone": "03 3229073", "role": null }, { "id": "2182", "name": "Danielle Petrie", "email": "mrs.p.travels@gmail.com", "phone": "021 0245 7615", "role": null }, { "id": "175", "name": "Dave Clark", "email": "bndclark@xtra.co.nz", "phone": "326-6544", "role": null }, { "id": "1886", "name": "David Cockeram", "email": "davecockeram@gmail.com", "phone": "337-0948", "role": null }, { "id": "440", "name": "David Henson", "email": "david-henson@paradise.net.nz", "phone": "942-3954", "role": null }, { "id": "525", "name": "David Jenkinson", "email": "", "phone": "359-8166", "role": null }, { "id": "2085", "name": "David Rowley", "email": "dmrowley@gmail.com", "phone": "021 1055441", "role": null }, { "id": "900", "name": "David Selway", "email": "dselway@clear.net.nz", "phone": "03 326 3344", "role": null }, { "id": "1615", "name": "David Somerville", "email": "ds.nmconsulting@gmail.com", "phone": "+61414526246", "role": null }, { "id": "1830", "name": "David Sutton", "email": "Davidlsutton@yahoo.co.uk", "phone": "0211808081", "role": null }, { "id": "1030", "name": "David Watson", "email": "David.Watson@cdhb.govt.nz", "phone": "981-7929", "role": null }, { "id": "265", "name": "Dayle Drummond", "email": "dayle.drum@gmail.com", "phone": "337-1718", "role": null }, { "id": "2141", "name": "Dean Herring", "email": "dean.herring@gmail.com", "phone": "021950768", "role": null }, { "id": "2167", "name": "Debbie Bevins", "email": "debbie.bevins@gmail.com", "phone": "021 775 165", "role": null }, { "id": "917", "name": "Deirdre Sheppard", "email": "d_sheppard@clear.net.nz", "phone": "342-7929", "role": null }, { "id": "2127", "name": "Delwyn Bassett", "email": "delwynbassett@hotmail.co.nz", "phone": "027 220 7813", "role": null }, { "id": "955", "name": "Denise Stroud", "email": "denisefs2001@yahoo.co.nz", "phone": "339-4368", "role": null }, { "id": "200", "name": "Derek Collins", "email": "derekcollins@xtra.co.nz", "phone": "03-318-7447", "role": null }, { "id": "566", "name": "Diana Kirpensteijn", "email": "diana@jkkkayaks.co.nz", "phone": "332-7228", "role": null }, { "id": "155", "name": "Donald Carnielo", "email": "", "phone": "338-9865", "role": null }, { "id": "432", "name": "Doug Forster", "email": "doug@forster.net.nz", "phone": "337-5453", "role": "Webmaster" }, { "id": "1928", "name": "Doug Hueston", "email": "dph164@netspeed.net.nz", "phone": "325-7572", "role": null }, { "id": "670", "name": "Doug Napier", "email": "doug.nel@ihug.co.nz", "phone": "332-5879", "role": null }, { "id": "2181", "name": "Dougal Canard", "email": "dougalbass@hotmail.com", "phone": "03 374 6354", "role": null }, { "id": "2065", "name": "Duncan Bright", "email": "duncanbright@hotmail.com", "phone": "027 333 0227", "role": null }, { "id": "690", "name": "Easy Erik Norder", "email": "erik@tba.co.nz", "phone": "0221637756", "role": null }, { "id": "2131", "name": "Elizabeth Eadon", "email": "drelizabethmej@gmail.com", "phone": "03 3764453", "role": "Day Trip Organiser" }, { "id": "2168", "name": "Emily MacDonald", "email": "macdemily@gmail.com", "phone": "021 251 4477", "role": null }, { "id": "1887", "name": "Emma Bosworth", "email": "emma_bosworth1969@hotmail.com", "phone": "326-6411", "role": null }, { "id": "1820", "name": "Eric Park", "email": "eric.park6@gmail.com", "phone": "027-4791295", "role": null }, { "id": "795", "name": "Eric Saggers", "email": "ursi.eric.saggers@clear.net.nz", "phone": "385-9234", "role": null }, { "id": "2170", "name": "Eric Skea", "email": "skea.eric@gmail.com", "phone": "021 0247 5473", "role": null }, { "id": "2201", "name": "Erin Diao", "email": "diaoshiyu@hotmail.com", "phone": "021 0825 8266", "role": null }, { "id": "2073", "name": "Esme Park", "email": "eunsunjjang@gmail.com", "phone": "3572213", "role": null }, { "id": "1395", "name": "Fiona Findlater", "email": "i.a.findlater@xtra.co.nz", "phone": "359-4981", "role": null }, { "id": "770", "name": "Flo Roberts", "email": "tramperflo@paradise.net.nz", "phone": "980-7913", "role": null }, { "id": "2031", "name": "Gareth Caves", "email": "ggrcaves@gmail.com", "phone": "027 882 5563", "role": null }, { "id": "365", "name": "Gareth Gilbert", "email": "gilbert.gareth@gmail.com", "phone": "981-1737", "role": null }, { "id": "2074", "name": "Geoff Titmuss", "email": "titmuss.family@xtra.co.nz", "phone": "0277772440", "role": null }, { "id": "1082", "name": "George Witty", "email": "", "phone": "385-2132", "role": null }, { "id": "2154", "name": "Gloria Lee", "email": "tjdrhd2580@hotmail.com", "phone": "021 0291 5297", "role": null }, { "id": "1992", "name": "Gonzalo Javier Rodriguez", "email": "gonrm@hotmail.com", "phone": "021 2994307", "role": null }, { "id": "1987", "name": "Gort Stephan", "email": "gortstep@yahoo.com", "phone": "384 8233", "role": null }, { "id": "1060", "name": "Graham White", "email": "", "phone": "03-528-7172", "role": null }, { "id": "80", "name": "Grant Bawden", "email": "", "phone": "332-0765", "role": null }, { "id": "725", "name": "Grant Piper", "email": "grubbie@ihug.co.nz", "phone": "338-8926", "role": null }, { "id": "1050", "name": "Grant Wheaton", "email": "Grant.Wheaton@med.govt.nz", "phone": null, "role": null }, { "id": "1868", "name": "Greg Hill", "email": "greghill2002@gmail.com", "phone": "0272755550", "role": null }, { "id": "2153", "name": "Greg Petersen", "email": "gregory.petersen@hotmail.com", "phone": "03 385 4022", "role": null }, { "id": "1006", "name": "Greta Vink", "email": "greta-vink@clear.net.nz", "phone": "352-5329", "role": null }, { "id": "2097", "name": "Guy Woods", "email": "guy_woods@hotmail.com", "phone": "021 884928", "role": null }, { "id": "2156", "name": "Harpreet Kaur", "email": "preet.cherry18@gmail.com", "phone": "022 046 6323", "role": null }, { "id": "1685", "name": "Hayley Comis", "email": "hails_mc@yahoo.com.au", "phone": "337-2913", "role": null }, { "id": "180", "name": "Heather Clay", "email": "heather@heatherclay.co.nz", "phone": "021-887767", "role": null }, { "id": "2147", "name": "Heather Robb", "email": "hjrobb@xtra.co.nz", "phone": "03 358 5250", "role": null }, { "id": "1420", "name": "Helen Hulme", "email": "helenwilliams40@hotmail.co.uk", "phone": "03-325-6211", "role": null }, { "id": "2179", "name": "Hilde Hoogterp", "email": "hildehoogterp@hotmail.com", "phone": "027 80 111 04", "role": null }, { "id": "562", "name": "Honora Renwick", "email": "honora.renwick@cdhb.health.nz", "phone": "942-8368", "role": null }, { "id": "245", "name": "Iain Dephoff", "email": "idephoff@gmail.com", "phone": "0211494430", "role": null }, { "id": "1400", "name": "Iain Findlater", "email": "i.a.findlater@xtra.co.nz", "phone": "359-4981", "role": null }, { "id": "1916", "name": "Ian Costello", "email": "iancostellonz@gmail.com", "phone": "027-4089647", "role": null }, { "id": "275", "name": "Ian Dunn", "email": "ianrdunn24@gmail.com", "phone": "0212141907", "role": null }, { "id": "81", "name": "Irene Bawden", "email": "", "phone": "332-0765", "role": null }, { "id": "2188", "name": "Ivo Rongen", "email": "rongen.ivo@gmail.com", "phone": "021 0247 0850", "role": null }, { "id": "585", "name": "Ivor Lewis", "email": "iklewis@xtra.co.nz", "phone": "03-347-8372", "role": null }, { "id": "2040", "name": "Jacqui O'Neill", "email": "jacqui.o@xtra.co.nz", "phone": "03 3592018", "role": null }, { "id": "2050", "name": "James Hopkins", "email": "snikpohsemaj@gmail.com", "phone": "022 026 0504", "role": null }, { "id": "615", "name": "James MacQueen", "email": "james.macqueen@akl.bdospicers.com", "phone": "09 524-8647", "role": null }, { "id": "565", "name": "Jan Kees Kirpensteijn", "email": "diana@jkkkayaks.co.nz", "phone": "332-7228", "role": null }, { "id": "1888", "name": "Jan Mitchell", "email": "janiam@orcon.net.nz", "phone": "021526655", "role": null }, { "id": "1275", "name": "Jane Mulholland", "email": "t.j.mulholland@xtra.co.nz", "phone": "03-318-7978", "role": null }, { "id": "2115", "name": "Janey Thomas", "email": "graphik@xtra.co.nz", "phone": "03 314 9514", "role": null }, { "id": "1891", "name": "Janice Antill", "email": "antillyoung@amuri.net", "phone": "03-314-6997", "role": null }, { "id": "631", "name": "Jean McCurdy", "email": "", "phone": "326-6121", "role": null }, { "id": "412", "name": "Jeff Hall", "email": "jeff.hall2@lifetech.com", "phone": "338-0922", "role": null }, { "id": "780", "name": "Jeffrey Rogers", "email": "jeff.chris@xtra.co.nz", "phone": "03 313 8432", "role": null }, { "id": "405", "name": "Jenny Harlow", "email": "pumpkinnz@gmail.com", "phone": "349-2280", "role": "Webmaster" }, { "id": "207", "name": "Jill Cox", "email": "chris.cox@xtra.co.nz", "phone": "03-219-1414", "role": null }, { "id": "1966", "name": "Jim Knight", "email": "jimknight24@xtra.co.nz", "phone": "03 3147447", "role": null }, { "id": "660", "name": "Jim McKie", "email": "jim.mckie105@paradise.net.nz", "phone": "352-6036", "role": null }, { "id": "1045", "name": "Jim Western", "email": "jimwestern@xtra.co.nz", "phone": "384 7843", "role": null }, { "id": "2164", "name": "Jo Steven", "email": "nzkeatramps@gmail.com", "phone": "021 848 160", "role": null }, { "id": "2079", "name": "Joanne Marie Parker", "email": "pukenui33@gmail.com", "phone": "027 3066766", "role": null }, { "id": "30", "name": "Joe Arts", "email": "jaam12000@gmail.com", "phone": "980-9729", "role": null }, { "id": "70", "name": "John Barnes", "email": "jae.barnes@xtra.co.nz", "phone": "388-5499", "role": null }, { "id": "290", "name": "John Easton", "email": "easton.j@paradise.net.nz", "phone": "981-9414", "role": null }, { "id": "630", "name": "John McCurdy", "email": "", "phone": "326-6121", "role": null }, { "id": "920", "name": "John Shrewsbury", "email": null, "phone": "021-747-397", "role": null }, { "id": "1010", "name": "John Visser", "email": "lucullus@paradise.net.nz", "phone": "981-7312", "role": null }, { "id": "160", "name": "Jonathan Carr", "email": "jonathan@jonathancarr.com", "phone": "351-1574", "role": null }, { "id": "2083", "name": "Joshua Johnson", "email": "jopjohns@mtu.edu", "phone": "0278865868", "role": null }, { "id": "1365", "name": "Julie Haywood", "email": "juliehaywood1@yahoo.co.nz", "phone": "0211799190", "role": null }, { "id": "2004", "name": "Karen Garrick", "email": "karren.garric@gmail.com", "phone": "3372914", "role": null }, { "id": "2120", "name": "Karen Tait", "email": "karenjtait@gmail.com", "phone": "027 520 6464", "role": null }, { "id": "1665", "name": "Kate Taylor", "email": "katet5003@gmail.com", "phone": "027 882 5563", "role": null }, { "id": "2034", "name": "Kate Wills", "email": "kiwioutthere@gmail.com", "phone": "03-550-7166", "role": null }, { "id": "1885", "name": "Kathy Basire", "email": "kb@raydon.co.nz", "phone": "0211808081", "role": null }, { "id": "1325", "name": "Kay Taylor", "email": "kaytaylor30@xtra.co.nz", "phone": "03358-4580", "role": null }, { "id": "1880", "name": "Kees De Jager", "email": "kees.dejager162@gmail.com", "phone": "0272306450", "role": null }, { "id": "240", "name": "Keith Dekkers", "email": "keithdek@hotmail.com", "phone": "332-1908", "role": null }, { "id": "2175", "name": "Kelly Purdie", "email": "bristolblonde32@hotmail.com", "phone": "027 2215220", "role": null }, { "id": "75", "name": "Kelvin Bartram", "email": "kbartram@globe.net.nz", "phone": "342-7436", "role": null }, { "id": "230", "name": "Ken Dawson", "email": "", "phone": "384-9542", "role": null }, { "id": "930", "name": "Kerrie Maynard", "email": "kerrievm@yahoo.co.nz", "phone": "386-2850", "role": null }, { "id": "1867", "name": "Kerrie Smith", "email": "adrian.busby1@gmail.com", "phone": "325-5001", "role": null }, { "id": "1979", "name": "Kevin Knight", "email": "mrkdk@hotmail.com", "phone": "942 7430", "role": null }, { "id": "1881", "name": "Kevin Wakeham", "email": "k.f.wakeham@paradise.net.nz", "phone": "358-8328", "role": null }, { "id": "2132", "name": "Kieran Eadon-Jones", "email": "drelizabethmej@gmail.com", "phone": "027 952 2315", "role": null }, { "id": "640", "name": "Kieran McGuigan", "email": "kmcg@actrix.co.nz", "phone": "339-4368", "role": null }, { "id": "2163", "name": "Kieran Scott", "email": "watsanman@gmail.com", "phone": "03 741 1756", "role": null }, { "id": "2172", "name": "Kim Harburg", "email": "kimharburg@hotmail.com", "phone": "0211922043", "role": null }, { "id": "1985", "name": "Kim Swarbrick", "email": "kim.swarbrick@ccc.govt.nz", "phone": "03 960 7644", "role": null }, { "id": "1933", "name": "Klemens Stampfli", "email": "klem.stampfli@gmail.com", "phone": "03 3554004", "role": null }, { "id": "1810", "name": "Laurayne Devery", "email": "lkrobb@hotmail.com", "phone": "339-8869", "role": null }, { "id": "2161", "name": "Laurent De Maudave Bestel", "email": "lbestel74@gmail.com", "phone": "03 428 6413", "role": null }, { "id": "2077", "name": "Leah Witton", "email": "godbothera@hotmail.com", "phone": "0278142446", "role": null }, { "id": "540", "name": "Les Jones", "email": "Lesjones83@gmail.com", "phone": "980-8100", "role": null }, { "id": "1970", "name": "Li Li", "email": "ahhlili01@hotmail.com", "phone": "0212363211", "role": null }, { "id": "2171", "name": "Linda Kroening", "email": "lindakroening@gmail.com", "phone": "03 383 4763", "role": null }, { "id": "590", "name": "Linda Lilburne", "email": "lilburnel@landcareResearch.co.nz", "phone": "332-2502", "role": null }, { "id": "2187", "name": "Lindsay Walton", "email": "lwaltonnz@gmail.com", "phone": "03 741 1011", "role": null }, { "id": "370", "name": "Lisa Glading", "email": "lisey@clear.net.nz", "phone": "981-1737", "role": null }, { "id": "2022", "name": "Lisa McArthur", "email": "lisa_d_mcarthur@yahoo.com", "phone": null, "role": null }, { "id": "2066", "name": "Lisa McKinnon", "email": "lisamckinn@gmail.com", "phone": "03 967 3146", "role": null }, { "id": "1984", "name": "Liz Stephenson", "email": "trampingtrip@gmail.com", "phone": "03 358 3281", "role": null }, { "id": "1918", "name": "Liz Tanner", "email": "lizjtanner@gmail.com", "phone": "0211400531", "role": null }, { "id": "1875", "name": "Liz Van Ekeris", "email": "lizzievanekeris@gmail.com", "phone": "337-0948", "role": null }, { "id": "2169", "name": "Lorraine Poole", "email": "candl.poole@gmail.com", "phone": "332 2864", "role": null }, { "id": "2191", "name": "Louise Ydgren", "email": "louisexj@hotmail.com", "phone": "027 258 8829", "role": null }, { "id": "1620", "name": "Lovisa Eriksson", "email": "lilla_krakan@hotmail.com", "phone": "337-3925", "role": null }, { "id": "1031", "name": "Lynda Watson", "email": "David.Watson@cdhb.govt.nz", "phone": "981-7929", "role": null }, { "id": "410", "name": "Lynette Hartley", "email": "lhartley@canterburymuseum.com", "phone": "338-0922", "role": null }, { "id": "165", "name": "Malcolm Carr", "email": "malcolmcarr@clear.net.nz", "phone": "960-5281", "role": null }, { "id": "2111", "name": "Manpreet (Mani) Singh", "email": "preet323@gmail.com", "phone": "027-931-8323", "role": null }, { "id": "77", "name": "Marcia Bartram", "email": "kbartram@globe.net.nz", "phone": "342-7436", "role": null }, { "id": "2045", "name": "Margaret Grace", "email": "mgrace99@clear.net.nz", "phone": "03 9671960", "role": null }, { "id": "605", "name": "Margaret Lovell-Smith", "email": "margls@slingshot.co.nz", "phone": "351-9946", "role": null }, { "id": "700", "name": "Margie O'Reilly", "email": "margierose1@hotmail.com", "phone": "942-7670", "role": null }, { "id": "2178", "name": "Mariusz Madry", "email": "marius.madry@gmail.com", "phone": "021 046 0150", "role": null }, { "id": "2126", "name": "Mark Watson", "email": "mark.waipapa@gmail.com", "phone": "329 3178", "role": null }, { "id": "1215", "name": "Martin Brown", "email": "martinbrown5611@yahoo.co.nz", "phone": "3899468", "role": null }, { "id": "975", "name": "Martin Thomson", "email": "", "phone": "332-4695", "role": null }, { "id": "2183", "name": "Mary Ann Phillips", "email": "cuddly111@hotmail.com", "phone": "027 328 3978", "role": null }, { "id": "2044", "name": "Mathew Crombie", "email": "matt_crombie@hotmail.com", "phone": "03 3321578", "role": null }, { "id": "2140", "name": "Matt Burke", "email": "mattburke@gmail.com", "phone": "021 107 8205", "role": null }, { "id": "1965", "name": "Matt Gunn", "email": "m.gunn@clear.net.nz", "phone": "332 8704", "role": null }, { "id": "2119", "name": "Maureen Bennett", "email": "vwrox@hotmail.com", "phone": "03 3592661", "role": null }, { "id": "55", "name": "Maurice Baigent", "email": "", "phone": "384-3141", "role": null }, { "id": "235", "name": "Max De Lacey", "email": "", "phone": "03-688-8342", "role": null }, { "id": "1975", "name": "Megan Gee", "email": "megan.gee@plantandfood.co.nz", "phone": "0211 20 30 27", "role": null }, { "id": "5", "name": "Melissa Abelard", "email": "stanley@cit.co.nz", "phone": "332-2760", "role": null }, { "id": "20", "name": "Michael Anderson", "email": "jean.reidy@clear.net.nz", "phone": "04-973-9952", "role": null }, { "id": "2202", "name": "Michael Hammond", "email": "mbahammond@hotmail.com", "phone": "02108414764", "role": null }, { "id": "2142", "name": "Michael Hawke", "email": "hawke.michael@icloud.com", "phone": "027 949 1027", "role": null }, { "id": "2173", "name": "Michael Meehan", "email": "mmeehan@uoguelph.ca", "phone": "0211922043", "role": null }, { "id": "675", "name": "Michael Newlove", "email": "newmike@slingshot.co.nz", "phone": "355-8360", "role": null }, { "id": "695", "name": "Michael Ny", "email": "masma@xtra.co.nz", "phone": "337-9796", "role": null }, { "id": "2180", "name": "Michel Holleman", "email": "michel_holleman@hotmail.com", "phone": "027 80 111 04", "role": null }, { "id": "475", "name": "Michele Hood", "email": "mickyh42@xtra.co.nz", "phone": "027 331 4779", "role": null }, { "id": "665", "name": "Michele McKnight", "email": "Michelemcknight@xtra.co.nz", "phone": "960-7538", "role": null }, { "id": "2104", "name": "Mike Freeman", "email": "mike@mikefreeman.co.nz", "phone": "021 957 563", "role": null }, { "id": "610", "name": "Mike Lugg", "email": "mike@learningstaircase.co.nz", "phone": "03 313 3625", "role": null }, { "id": "2186", "name": "Mohammad Ayat", "email": "mohamad.ayat@gmail.com", "phone": "03 341 2024", "role": null }, { "id": "2103", "name": "Mohini Sukhapure", "email": "mohini.sre@gmail.com", "phone": "021 0820 5388", "role": null }, { "id": "2203", "name": "Morag Pringle", "email": "morag_pringle@yahoo.co.nz", "phone": "03 974 2547", "role": null }, { "id": "2039", "name": "Morwenna Malcolm", "email": "morwenny@gmail.com", "phone": "027 633 2093", "role": null }, { "id": "2098", "name": "Natasha Sydorenko", "email": "n.sydorenko@hotmail.com", "phone": "0223140684", "role": null }, { "id": "672", "name": "Nellie Vink", "email": "doug.nel@ihug.co.nz", "phone": "332-5879", "role": null }, { "id": "1470", "name": "Nick Maeder", "email": "iceaxe@paradise.net.nz", "phone": "981-7212", "role": null }, { "id": "2086", "name": "Nikki Kear", "email": "nikki.kear@gmail.com", "phone": "027 3334577", "role": null }, { "id": "995", "name": "Noel Tweedie", "email": "", "phone": "332-5493", "role": null }, { "id": "2189", "name": "Noel Walker", "email": "noelw08@gmail.com", "phone": "022 643 5441", "role": null }, { "id": "51", "name": "Noeline Marsh", "email": "Noeline.marsh@clear.net.nz", "phone": "03-942-1519", "role": null }, { "id": "2192", "name": "Onola Sutherland", "email": "zrobga@gmail.com", "phone": "03 351 2948", "role": null }, { "id": "2087", "name": "Pablo De Oliveira", "email": "pablosoares88@hotmail.com", "phone": "0211549387", "role": null }, { "id": "441", "name": "Pat Henson", "email": "david-henson@paradise.net.nz", "phone": "942-3954", "role": null }, { "id": "1982", "name": "Paul Focamp", "email": "pfocamp@hotmail.com", "phone": null, "role": null }, { "id": "1440", "name": "Paul Titus", "email": "titus@paradise.net.nz", "phone": "981-5690", "role": null }, { "id": "195", "name": "Penny Coffey", "email": "Penny.Coffey@cdhb.health.nz", "phone": "332-7182", "role": null }, { "id": "2007", "name": "Peter Coleman", "email": "pfranciscoleman@gmail.com", "phone": "03 335 0891", "role": null }, { "id": "2162", "name": "Peter Drinkwater", "email": "pdrinkwater.pd@googlemail.com", "phone": "027 225 5141", "role": null }, { "id": "305", "name": "Peter Eman", "email": "petee@slingshot.co.nz", "phone": "337-3003", "role": null }, { "id": "460", "name": "Peter Hinchey", "email": "peterhinchey@gmail.com", "phone": "0061 8 92956529", "role": null }, { "id": "1660", "name": "Philip Hulme", "email": "phil_hulme@hotmail.com", "phone": "03-325-6211", "role": null }, { "id": "990", "name": "Philip Tree", "email": "philip.tree@tait.co.nz", "phone": "942-7670", "role": null }, { "id": "2138", "name": "Phillipa Hawkes", "email": "pip.hawkes@gmail.com", "phone": "021 0813 7030", "role": null }, { "id": "1920", "name": "Rachel Innocente", "email": "brown.rm@hotmail.com", "phone": "385-2452", "role": null }, { "id": "2099", "name": "Radu Popovici", "email": "popovici.radustefan@gmail.com", "phone": "0275532126", "role": null }, { "id": "90", "name": "Raymond Begg", "email": "r.begg@inet.net.nz", "phone": "384-2129", "role": null }, { "id": "1005", "name": "Rex Vink", "email": "greta-vink@clear.net.nz", "phone": "352-5329", "role": null }, { "id": "1996", "name": "Richard Kimberley", "email": "janeandrichard@xtra.co.nz", "phone": "326 6158", "role": null }, { "id": "595", "name": "Richard Lobb", "email": "trampgeek@gmail.com", "phone": "351-2344", "role": "Webmaster" }, { "id": "980", "name": "Richard Thwaites", "email": "rick.t@clear.net.nz", "phone": "349-0411", "role": null }, { "id": "735", "name": "Robert Rainsbury", "email": "robert@rainsbury.co.nz", "phone": "338-1933", "role": null }, { "id": "2160", "name": "Rodger Smith", "email": "ericandpodge@gmail.com", "phone": "022 485 0124", "role": null }, { "id": "310", "name": "Rodney Erickson", "email": "roddus@xtra.co.nz", "phone": "03-312-4990", "role": null }, { "id": "2190", "name": "Roger Thomas", "email": "rogerthomas@xtra.co.nz", "phone": "03 314 9514", "role": null }, { "id": "2165", "name": "Roi Gapuzan", "email": "gapuzanr@yahoo.co.nz", "phone": "03 360 2994", "role": null }, { "id": "546", "name": "Ron Keeble", "email": "sue.n.ron@xtra.co.nz", "phone": "337-4914", "role": null }, { "id": "375", "name": "Ruha Goodwill", "email": "nigel.ruha@slingshot.co.nz", "phone": "347-2612", "role": null }, { "id": "1180", "name": "Ruth Gray", "email": "ruthterina@yahoo.co.nz", "phone": "3745547", "role": null }, { "id": "2196", "name": "Ruth Todd", "email": "getruthtodd@gmail.com", "phone": "03 351 1813", "role": null }, { "id": "985", "name": "Ruth Tramschek", "email": "ruth.tramschek@cdhb.govt.nz", "phone": "337-3003", "role": null }, { "id": "2069", "name": "Sally Maynard", "email": "salzmay@yahoo.co.nz", "phone": "03 388 2421", "role": null }, { "id": "2020", "name": "Sam Newhouse", "email": "sam_newhouse@hotmail.com", "phone": "981 4010", "role": null }, { "id": "395", "name": "Sarah Hardie", "email": "Sarah.andrew@vodafone.co.nz", "phone": "332-8275", "role": null }, { "id": "2184", "name": "Sarah Maghzal", "email": "speedy2082@hotmail.com", "phone": null, "role": null }, { "id": "2139", "name": "Sarah Rampley", "email": "sarahrampley20@gmail.com", "phone": "021 107 8205", "role": null }, { "id": "345", "name": "Scott Fowler", "email": "sam7doc@yahoo.co.nz", "phone": "386-2850", "role": null }, { "id": "2176", "name": "Scott Sutherland", "email": "antipodes.trading@gmail.com", "phone": "027 330 1698", "role": null }, { "id": "2158", "name": "Shannon Reardon", "email": "microtechnologiesnz@gmail.com", "phone": "0226073026", "role": null }, { "id": "902", "name": "Sharon Brophy", "email": "sharon.m.brophy@gmail.com", "phone": "0211258158", "role": null }, { "id": "2137", "name": "Shaun Wong", "email": "shaunwong@mail.com", "phone": "021 234 6847", "role": null }, { "id": "1977", "name": "Silvia Horniakova", "email": "silwika@yahoo.com", "phone": "021 264 8430", "role": null }, { "id": "2155", "name": "Sonya Wang", "email": "sonya.ww@hotmail.com", "phone": "03 348 6838", "role": null }, { "id": "415", "name": "Stephen Heald", "email": "healds@ihug.co.nz", "phone": "03-302-7526", "role": null }, { "id": "95", "name": "Steve Berry", "email": "stevescontact@gmail.com", "phone": "337-3263", "role": null }, { "id": "110", "name": "Steve Brasch", "email": "steve.brasch.nz@gmail.com", "phone": "384-7166", "role": null }, { "id": "135", "name": "Steve Bruerton", "email": "steve.ngaire@xtra.co.nz", "phone": "322-6196", "role": null }, { "id": "940", "name": "Stewart Smith", "email": "tramperflo@paradise.net.nz", "phone": "980-7913", "role": null }, { "id": "430", "name": "Sue Hely", "email": "suehely@forster.net.nz", "phone": "337-5453", "role": null }, { "id": "1913", "name": "Sue Murray", "email": "Peterhinchey@gmail.com", "phone": "0061 8 92956529", "role": null }, { "id": "727", "name": "Sue Napier", "email": "np@riccarton.school.nz", "phone": "338-8926", "role": null }, { "id": "2195", "name": "Sumit Anand", "email": "sumit_anand_4@hotmail.com", "phone": "03 335 0708", "role": null }, { "id": "1983", "name": "Susan Cotton", "email": "susanmeryl@gmail.com", "phone": "960 9491", "role": null }, { "id": "545", "name": "Susan Pearson", "email": "susan@toniq.co.nz", "phone": "337-4914", "role": null }, { "id": "2152", "name": "Suzy Petersen", "email": "Suzy.petersen@outlook.com", "phone": "03 385 4022", "role": null }, { "id": "580", "name": "Terry Leonard", "email": "", "phone": "348-7200", "role": null }, { "id": "1899", "name": "Thomas Matern", "email": "matern.nz@gmail.com", "phone": "354-4309", "role": null }, { "id": "2159", "name": "Tina Guan", "email": "tina68778@hotmail.com", "phone": "03 358 5628", "role": null }, { "id": "300", "name": "Todd Ellis", "email": "toddellis@xtra.co.nz", "phone": "355-6613", "role": null }, { "id": "495", "name": "Tomyu Hu", "email": "tomyuhu@gmail.com", "phone": "03 3433 887", "role": null }, { "id": "2125", "name": "Toni Bachvarova", "email": "theeeyorefan@gmail.com", "phone": "+61447330083", "role": null }, { "id": "1061", "name": "Valda White", "email": "", "phone": "03-528-7172", "role": null }, { "id": "2000", "name": "Virginia Ellis", "email": "virginia.ellis014@gmail.com", "phone": "021 2064 305", "role": null }, { "id": "2149", "name": "Virginia Kneebone", "email": "VKAssoc@access.net.au", "phone": "021 713 873", "role": null }, { "id": "255", "name": "Warwick Dowling", "email": "warwick.dowling@gmail.com", "phone": "021 35 4545", "role": "Webmaster" }, { "id": "1225", "name": "William Blake", "email": "william.blake@xtra.co.nz", "phone": "343-5571", "role": null }, { "id": "2052", "name": "William King", "email": "wchking@yahoo.co.nz", "phone": "03 3578922", "role": null }, { "id": "2082", "name": "Winsome Brown", "email": "winsome246@gmail.com", "phone": "03 3137893", "role": null }, { "id": "2037", "name": "Xiaoqiu Jiang", "email": "guanyinlaomu@hotmail.com", "phone": "0211 470 680", "role": null }], "nonmembers": [], "editid": 94 };

                        if (ValidateResponse(response)) {
                            // cache these values
                            config = response.config;
                            metadata = response.metadata;
                            userId = response.userid;
                            editId = response.editid;
                            participants = response.participants ? response.participants.map(function (participant) {
                                return new Participant(participant, response.metadata.participants);
                            }) : [];
                            members = response.members ? response.members : [];
                            nonmembers = response.nonmembers ? response.nonmembers : [];

                            edits = response.edits ? response.edits : [];
                            modifications = response.modifications ? response.modifications : [];
                            changes = response.changes ? response.changes : [];

                            // resolve on this value
                            return new Trip(response.trip, response.metadata.trips);
                        }
                    });
            }

            function getConfig() {
                return $q.when(config);
            }

            function getMetadata() {
                return $q.when(metadata);
            }

            function getUserId() {
                return $q.when(userId);
            }

            function getEditId() {
                return $q.when(editId);
            }

            function getParticipants() {
                return $q.when(participants);
            }

            function getChanges() {
                return $q.when(changes);
            }

            function getMembers() {
                return $q.when(members);
            }

            function getNonmembers() {
                return $q.when(nonmembers);
            }

            function getEdits() {
                return $q.when(edits);
            }

            function getModifications() {
                return $q.when(modifications);
            }

            //---------------------------------

            function putTrip(tripId, diffs) {
                return $http.post("api.post.php", { tripid: tripId, diffs: diffs })
                    .then(function (response) {
                        if (ValidateResponse(result)) {
                            return $http.get("api.get.php?action=gettrip&editid=" + editid + "&tripid=" + tripid)
                                .then(function (response) {
                                    if (ValidateResponse(response)) {
                                        return new Trip(response.trip, response.metadata.trips);
                                    }
                                });
                        }
                    });
            };


            //---------------------------------

            function closeEditSession(editId) {
                return $http.get("api.get.php?action=editend&editid=" + editId);
            };

            //---------------------------------

            function ValidateResponse(response) {
                if (typeof (response) == "string") {
                    state.savestate = response;
                    state.$timeout(function () { state.$scope.$apply(); }, 0);
                }
                return typeof (response) == "object";
            }

            //---------------------------------

            return {
                getTripGroups: getTripGroups,

                getTrip: getTrip,
                getConfig: getConfig,
                getMetadata: getMetadata,
                getUserId: getUserId,
                getEditId: getEditId,
                getParticipants: getParticipants,
                getChanges: getChanges,
                getMembers: getMembers,
                getNonmembers: getNonmembers,
                getEdits: getEdits,
                getModifications: getModifications,

                putTrip: putTrip,

                closeEditSession: closeEditSession
            }
        }]
    );

}());
